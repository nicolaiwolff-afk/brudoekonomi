<!DOCTYPE html>
<html lang="da">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Brudøkonomi</title>

  <style>
    body { font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
           background: #f6f7f8; margin: 0; color: #111; }
    .wrap { max-width: 900px; margin: 0 auto; padding: 38px 18px; }
    .card { background: #fff; border: 1px solid #e7e7e7; border-radius: 14px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.06); padding: 18px; }
    h1 { margin: 0 0 10px; font-size: 1.8rem; }
    label { display: block; margin-top: 14px; font-weight: 600; }
    input { width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #ccc;
            font-size: 1rem; margin-top: 6px; }
    button { margin-top: 20px; padding: 14px; border-radius: 10px; border: 0;
             background: #111; color: #fff; font-size: 1rem; width: 100%; cursor: pointer; }
    .box { margin-top: 20px; background: #fafafa; border: 1px solid #eee;
            border-radius: 12px; padding: 14px; }
    .kpi { margin: 10px 0; }
    .muted { color: #666; margin-top: 10px; }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="card">
      <h1>Brudøkonomi</h1>
      <p>Indtast jeres nøgletal herunder og få et hurtigt overblik over boligøkonomien før du køber fuld rapport.</p>

      <label for="home">Boligens værdi</label>
      <input id="home" type="number" placeholder="fx 3.200.000">

      <label for="mortgage">Restgæld</label>
      <input id="mortgage" type="number" placeholder="fx 2.100.000">

      <label for="share">Din ejerandel (%)</label>
      <input id="share" type="number" placeholder="fx 50">

      <label for="income">Din månedlige indkomst</label>
      <input id="income" type="number" placeholder="fx 42.000">

      <label for="debt">Din øvrige gæld</label>
      <input id="debt" type="number" placeholder="fx 60.000">

      <button id="calcBtn" type="button">Beregn</button>

      <div id="preview" class="box" style="display:none;">
        <div class="kpi"><b>Din friværdi (andel):</b> <span id="p_equity">—</span></div>
        <div class="kpi"><b>Udbetaling til partner:</b> <span id="p_payout">—</span></div>
        <div class="kpi"><b>Gæld efter overtagelse:</b> <span id="p_total">—</span></div>
      </div>

      <button id="buyBtn" type="button" style="display:none;">Få fuld rapport</button>

      <p class="muted">“Få fuld rapport” dukker op når beregningen er lavet.</p>
    </div>
  </div>

<script>
(function(){

  // ✅ Dit Stripe betalingslink
  const STRIPE_PAYMENT_LINK = "https://buy.stripe.com/test_8x200beGV7Zv4PFaPJfQI00";

  const homeEl     = document.getElementById("home");
  const mortgageEl= document.getElementById("mortgage");
  const shareEl    = document.getElementById("share");
  const incomeEl   = document.getElementById("income");
  const debtEl     = document.getElementById("debt");
  const calcBtn    = document.getElementById("calcBtn");
  const buyBtn     = document.getElementById("buyBtn");

  const preview    = document.getElementById("preview");
  const p_equity   = document.getElementById("p_equity");
  const p_payout   = document.getElementById("p_payout");
  const p_total    = document.getElementById("p_total");

  function dkk(n){
    const v = Number(n);
    if(!Number.isFinite(v)) return "—";
    return new Intl.NumberFormat("da-DK", {
      style: "currency", currency: "DKK", maximumFractionDigits: 0
    }).format(v);
  }

  function buildReport(){
    const home = Number(homeEl.value || 0);
    const mortgage = Number(mortgageEl.value || 0);
    const sharePct = Number(shareEl.value || 0);
    const share    = sharePct / 100;
    const income   = Number(incomeEl.value || 0);
    const debt     = Number(debtEl.value || 0);

    const equity  = home - mortgage;
    const yourEquity = equity * share;
    const payout     = equity * (1 - share);
    const totalDebt  = mortgage + payout + debt;

    const report = {
      ts: new Date().toISOString(),
      homeValue: home,
      mortgage: mortgage,
      sharePct: sharePct,
      incomeMonthly: income,
      otherDebt: debt,
      equity: equity,
      saleProceeds: yourEquity,
      payoutToPartner: payout,
      totalDebtAfterTakeover: totalDebt
    };

    localStorage.setItem("brudoekonomi:last_report", JSON.stringify(report));
    return report;
  }

  calcBtn.addEventListener("click", () => {
    const r = buildReport();

    preview.style.display = "block";
    p_equity.textContent = dkk(r.saleProceeds);
    p_payout.textContent = dkk(r.payoutToPartner);
    p_total.textContent  = dkk(r.totalDebtAfterTakeover);

    buyBtn.style.display = "block";
  });

  buyBtn.addEventListener("click", () => {
    // Gem rapporten igen
    buildReport();

    if(!STRIPE_PAYMENT_LINK || STRIPE_PAYMENT_LINK.includes("stripe.com/test_")){
      window.location.href = STRIPE_PAYMENT_LINK;
    } else {
      alert("Der er et problem med Stripe-linket. Tjek index.html.");
    }
  });

})();
</script>
</body>
</html>
