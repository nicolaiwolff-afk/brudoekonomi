<!DOCTYPE html>
<html lang="da">
<head>
<meta charset="UTF-8">
<title>Din rapport</title>
<style>
body{font-family:system-ui;background:#f6f7f8;margin:0}
.wrap{max-width:800px;margin:auto;padding:40px}
.card{background:#fff;padding:24px;border-radius:14px;box-shadow:0 10px 30px rgba(0,0,0,.08)}
.kpi{border-bottom:1px solid #eee;padding:10px 0}
</style>
</head>

<body>
<div class="wrap">
<div class="card">
<h1>Din rapport</h1>
<p id="status">Kontrollerer betaling…</p>

<div id="report" style="display:none">
<p class="kpi">Boligens værdi: <b id="r_home"></b></p>
<p class="kpi">Restgæld: <b id="r_mort"></b></p>
<p class="kpi">Din ejerandel: <b id="r_share"></b></p>
<p class="kpi">Indkomst: <b id="r_inc"></b></p>
<p class="kpi">Øvrig gæld: <b id="r_debt"></b></p>

<p class="kpi">Din friværdi: <b id="r_equity"></b></p>
<p class="kpi">Dit salgsudbytte: <b id="r_sale"></b></p>
<p class="kpi">Udbetaling til partner: <b id="r_payout"></b></p>
<p class="kpi">Samlet gæld efter overtagelse: <b id="r_total"></b></p>
</div>
</div>
</div>

<script>
const params = new URLSearchParams(location.search);
const session = params.get("session_id");

async function run(){
 const r = await fetch("/api/session-status?session_id="+session);
 const data = await r.json();

 if(!data.ok || !data.paid){
   status.textContent="Betaling ikke bekræftet";
   return;
 }

 status.textContent="Betaling bekræftet ✔";
 report.style.display="block";

 const rep = JSON.parse(localStorage.getItem("brudoekonomi:last_report"));

 function fmt(n){
  return new Intl.NumberFormat("da-DK",{style:"currency",currency:"DKK",maximumFractionDigits:0}).format(n)
 }

 r_home.textContent = fmt(rep.homeValue);
 r_mort.textContent = fmt(rep.mortgage);
 r_share.textContent = rep.sharePct+" %";
 r_inc.textContent = fmt(rep.incomeMonthly);
 r_debt.textContent = fmt(rep.otherDebt);
 r_equity.textContent = fmt(rep.equity);
 r_sale.textContent = fmt(rep.saleProceeds);
 r_payout.textContent = fmt(rep.payoutToPartner);
 r_total.textContent = fmt(rep.totalDebtAfterTakeover);
}

run();
</script>
</body>
</html>
